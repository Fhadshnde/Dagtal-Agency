(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{4933:(e,t,a)=>{Promise.resolve().then(a.bind(a,6310))},6310:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(5155),n=a(2115),l=a(6905),i=a.n(l),o=a(860),r=a(2615),c=a(6046);let p=()=>{var e;let{data:t,status:a}=(0,r.useSession)(),l=(0,c.useRouter)(),{data:p,mutate:d,error:u,isLoading:_}=(0,o.Ay)("authenticated"===a?"/api/posts?username=".concat(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.name):null,function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t).then(e=>e.json())});(0,n.useEffect)(()=>{"unauthenticated"===a&&l.push("/dashboard/login")},[a,l]);let h=async e=>{e.preventDefault();let a=e.target[0].value,s=e.target[1].value,n=e.target[2].value;try{await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:a,desc:s,content:n,username:t.user.name})}),d(),e.target.reset()}catch(e){console.log(e)}},g=async e=>{try{await fetch("/api/posts/".concat(e),{method:"DELETE"}),d()}catch(e){console.log(e)}};return"loading"===a?(0,s.jsx)("p",{children:"Loading..."}):"authenticated"===a?(0,s.jsxs)("div",{className:i().container,children:[(0,s.jsx)("div",{className:i().posts,children:_?"loading":null==p?void 0:p.map(e=>(0,s.jsxs)("div",{className:i().post,children:[(0,s.jsx)("h2",{className:i().postTitle,children:e.title}),(0,s.jsx)("p",{children:e.desc}),(0,s.jsx)("span",{className:i().delete,onClick:()=>g(e._id),children:"X"})]},e._id))}),(0,s.jsxs)("form",{className:i().new,onSubmit:h,children:[(0,s.jsx)("h1",{children:"Add New Post"}),(0,s.jsx)("input",{type:"text",placeholder:"Title",className:i().input}),(0,s.jsx)("input",{type:"text",placeholder:"Desc",className:i().input}),(0,s.jsx)("textarea",{placeholder:"Content",className:i().textArea,cols:"30",rows:"10"}),(0,s.jsx)("button",{className:i().button,children:"Send"})]})]}):null}},6905:e=>{e.exports={container:"page_container__nfYnh",posts:"page_posts__yHGtg",post:"page_post__ZYiVK",imgContainer:"page_imgContainer__nuqY9",img:"page_img__t0Z5T",delete:"page_delete__qtQ5Y",new:"page_new__wZniV",input:"page_input__IuUtw",textArea:"page_textArea__e3K81",button:"page_button__XiBV5"}}},e=>{var t=t=>e(e.s=t);e.O(0,[370,615,453,441,517,358],()=>t(4933)),_N_E=e.O()}]);